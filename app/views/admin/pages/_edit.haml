
-# %link{:href => "https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css", :rel => "stylesheet"}/
-# %script{:src => "https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"}
%script{:src => "https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"}

= form_for [:admin, page], builder: ActiveAdmin::FormBuilder do |f|
	= f.inputs :name => "Page" do
		= f.input :active
		%br
		= f.input :title
		= f.input :layout, as: :select, collection: Page::PAGE_LAYOUT
		= f.input :description, as: :string

	- f.has_many :components, new_record: true do | comp |
			
		%nav
			#nav-tab.nav.nav-tabs{:role => "tablist"}
				%a#nav-home-tab.nav-item.nav-link.active{"aria-controls" => "nav-home", "aria-selected" => "true", "data-toggle" => "tab", :href => "#nav-home-#{comp.object.id}", :role => "tab"} GENERAL
				%a#nav-profile-tab.nav-item.nav-link{"aria-controls" => "nav-profile", "aria-selected" => "false", "data-toggle" => "tab", :href => "#nav-profile-#{comp.object.id}", :role => "tab"} ATTACHMENTS
				%a#nav-contact-tab.nav-item.nav-link{"aria-controls" => "nav-contact", "aria-selected" => "false", "data-toggle" => "tab", :href => "#nav-contact-#{comp.object.id}", :role => "tab"} Contact

			#nav-tabContent.tab-content
				.tab-pane.fade.show.active{"aria-labelledby" => "nav-home-tab", :role => "tabpanel", id: "nav-home-#{comp.object.id}"}
					= f.inputs do
						- comp.input :name
						- comp.input :layout, collection: Component::COMPONENT_LAYOUT
						- comp.input :url_product
						- comp.input :url_text
						- comp.input :description, :input_html => { :rows => 5 }
						- comp.input :position
				.tab-pane.fade{"aria-labelledby" => "nav-profile-tab", :role => "tabpanel", id: "nav-profile-#{comp.object.id}", class: "testting"}
					- amount_attachments = f.object.attachments.size

					.row 
						- comp.has_many :attachments, allow_destroy: true, class:"custom-has-many-attachments col-4" do |attach|

							- if (url = attach.object.asset.url rescue nil).present?
								%img.img-center{"src": url, "style": "width:100px; height:100px"}
							- else
								%img.img-center{"src": "https://i.pinimg.com/originals/ae/8a/c2/ae8ac2fa217d23aadcc913989fcc34a2.png", "style": "width:100px; height:100px"}
								
							- attach.input :title
							- attach.input :note, :input_html => { :rows => 5 }
							- attach.input :asset, label: false

				.tab-pane.fade{"aria-labelledby" => "nav-contact-tab", :role => "tabpanel", id: "nav-contact-#{comp.object.id}"} ...

			%hr
			- if comp.object.id.present?
				=link_to admin_component_path(id: comp.object.id), method: :delete, style: "position: absolute; right: 0; top:0;" do
					%i.fa.fa-trash.text-danger
		.text-right
			= comp.actions
	= f.actions

	:javascript
		$(".has_many_container").addClass("row")